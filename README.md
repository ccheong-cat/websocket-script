This code was written by Manish. Committing to Git because I may be making a bunch of changes to it